{"version":3,"sources":["processor/intents/power-creeps/usePower.js"],"names":["_","require","utils","driver","getDriver","C","constants","module","exports","object","intent","scope","roomObjects","roomTerrain","gameTime","bulk","eventLog","roomController","isPowerEnabled","user","safeMode","powerInfo","POWER_INFO","power","creepPower","powers","target","level","cooldownTime","ops","isArray","store","range","id","dist","currentEffect","find","effects","i","endTime","applyEffectOnTarget","PWR_GENERATE_OPS","update","RESOURCE_OPS","effect","sum","calcResources","storeCapacity","amount","Math","min","resourceType","PWR_OPERATE_SPAWN","type","PWR_OPERATE_TOWER","PWR_OPERATE_STORAGE","PWR_OPERATE_LAB","PWR_OPERATE_EXTENSION","PWR_DISRUPT_TERMINAL","extensions","filter","off","energySent","energyLimit","energy","sort","comparatorDistance","every","extension","storeCapacityResource","PWR_OPERATE_OBSERVER","PWR_OPERATE_TERMINAL","PWR_DISRUPT_SPAWN","PWR_DISRUPT_TOWER","PWR_DISRUPT_SOURCE","PWR_REGEN_SOURCE","PWR_REGEN_MINERAL","mineralAmount","nextRegenerationTime","PWR_OPERATE_CONTROLLER","PWR_OPERATE_POWER","PWR_FORTIFY","PWR_SHIELD","constructionSite","x","y","remove","_id","checkConstructionSite","insert","room","hits","hitsMax","nextDecayTime","duration","PWR_OPERATE_FACTORY","Object","values","push","cooldown","event","EVENT_POWER","objectId","data","targetId","actionLog"],"mappings":"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","file":"../../../../processor/intents/power-creeps/usePower.js","sourceRoot":"/src"}